# üéØ –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ë–î + –°–ª–æ–≤–∞—Ä–∏–∫–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

### 1. –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ VacancyManager ‚úÖ

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ë–î:**
1. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ë–î
2. –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ ‚Üí –æ—Ç–¥–∞–µ–º —Å—Ä–∞–∑—É (cache)
3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ - –µ—Å–ª–∏ —É—Å—Ç–∞—Ä–µ–ª–∏ ‚Üí –∑–∞–ø—É—Å–∫–∞–µ–º —Ñ–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Worker
4. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç ‚Üí –ø–∞—Ä—Å–∏–º –°–ï–ô–ß–ê–° (fresh)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (–∏–∑ –∫–µ—à–∞)
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –æ—Ç–≤–µ—Ç–µ
- ‚úÖ –§–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

---

### 2. –°–∏—Å—Ç–µ–º–∞ —Å–ª–æ–≤–∞—Ä–∏–∫–æ–≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π ‚úÖ

**–ú–æ–¥–µ–ª—å –≤ –ë–î:**
```prisma
model ProfessionDictionary {
  id              String   @id
  source          String   // 'rabota.md', '999.md', 'makler.md'
  profession      String   // –ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
  professionId    String?  // ID —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ —Å–∞–π—Ç–µ
  category        String?  // –ö–∞—Ç–µ–≥–æ—Ä–∏—è
  synonyms        String[] // –°–∏–Ω–æ–Ω–∏–º—ã –¥–ª—è –ø–æ–∏—Å–∫–∞
  
  @@unique([source, profession])
}
```

**–§—É–Ω–∫—Ü–∏–∏:**
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Å–ª–æ–≤–∞—Ä–∏–∫–æ–≤ —Å 3 —Å–∞–π—Ç–æ–≤
- ‚úÖ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ —Å–ª–æ–≤–∞—Ä–∏–∫–∞–º
- ‚úÖ –ú–∞–ø–ø–∏–Ω–≥ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
- ‚úÖ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª–æ–≤–∞—Ä–∏–∫–æ–≤

---

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å (–ë–î –ø—É—Å—Ç–∞)
```bash
curl "http://localhost:3000/api/vacancies?keywords=developer"
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ë–î ‚Üí –ø—É—Å—Ç–æ
2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ ‚Üí –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π
3. **–ü–∞—Ä—Å–∏–º –°–ï–ô–ß–ê–°** (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
4. –í–æ–∑–≤—Ä–∞—â–∞–µ–º `source="fresh"`, ‚è±Ô∏è ~5 —Å–µ–∫—É–Ω–¥

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–¥–∞–Ω–Ω—ã–µ —Å–≤–µ–∂–∏–µ)
```bash
curl "http://localhost:3000/api/vacancies?keywords=developer"
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ë–î ‚Üí **–µ—Å—Ç—å 150 –≤–∞–∫–∞–Ω—Å–∏–π**
2. **–í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ä–∞–∑—É** `source="cache"`, ‚è±Ô∏è ~100–º—Å
3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ ‚Üí —Å–≤–µ–∂–∏–µ (<12 —á–∞—Å–æ–≤)
4. –§–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ù–ï –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –î–∞–Ω–Ω—ã–µ –µ—Å—Ç—å, –Ω–æ —É—Å—Ç–∞—Ä–µ–ª–∏
```bash
curl "http://localhost:3000/api/vacancies?keywords=developer"
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ë–î ‚Üí **–µ—Å—Ç—å 150 –≤–∞–∫–∞–Ω—Å–∏–π**
2. **–í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ä–∞–∑—É** `source="cache"`, ‚è±Ô∏è ~100–º—Å, `updating=true`
3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–≥–∏ ‚Üí —É—Å—Ç–∞—Ä–µ–ª–∏ (>12 —á–∞—Å–æ–≤)
4. **–ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** —á–µ—Ä–µ–∑ Worker
5. –°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ü–∞—Ä—Å–∏–Ω–≥ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
```bash
curl -X POST http://localhost:3000/api/vacancies/force-parse \
  -H "Content-Type: application/json" \
  -d '{"sources": ["rabota.md"], "searchQuery": "developer"}'
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ü–∞—Ä—Å–∏—Ç—Å—è **—Ç–æ–ª—å–∫–æ rabota.md**
2. –° –ø–æ–∏—Å–∫–æ–≤—ã–º –∑–∞–ø—Ä–æ—Å–æ–º "developer"
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç

---

## üìñ –†–∞–±–æ—Ç–∞ —Å–æ —Å–ª–æ–≤–∞—Ä–∏–∫–∞–º–∏

### 1. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–ª–æ–≤–∞—Ä–∏–∫–∏
```bash
# –ß–µ—Ä–µ–∑ API
curl -X POST http://localhost:3000/api/dictionaries/update

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é (—Å–∫—Ä–∏–ø—Ç)
npm run dict:update
```

### 2. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–ª–æ–≤–∞—Ä–∏–∫–∏
```bash
curl http://localhost:3000/api/dictionaries
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "rabota.md": [
      { "profession": "IT —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç", "professionId": "it" },
      { "profession": "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç", "professionId": "programmer" }
    ],
    "999.md": [
      { "profession": "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫", "professionId": "123" }
    ],
    "makler.md": [...]
  }
}
```

### 3. –ü–æ–ª—É—á–∏—Ç—å —Å–ª–æ–≤–∞—Ä–∏–∫ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
```bash
curl "http://localhost:3000/api/dictionaries?source=rabota.md"
```

### 4. –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
```bash
curl "http://localhost:3000/api/dictionaries/search?query=—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "searchQuery": "—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫",
    "mappings": [
      {
        "source": "rabota.md",
        "profession": "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç",
        "professionId": "programmer",
        "similarity": 0.9
      },
      {
        "source": "999.md",
        "profession": "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫",
        "professionId": "123",
        "similarity": 1.0
      },
      {
        "source": "makler.md",
        "profession": "IT —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç",
        "professionId": "2850",
        "similarity": 0.7
      }
    ]
  }
}
```

### 5. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–ª–æ–≤–∞—Ä–∏–∫–æ–≤
```bash
curl http://localhost:3000/api/dictionaries/stats
```

---

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –±–æ—Ç–µ

### 1. –ü–æ–ª—É—á–∏—Ç—å —Å–ª–æ–≤–∞—Ä–∏–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
```javascript
// –í –±–æ—Ç–µ —Ç–µ–ª–µ–≥—Ä–∞–º:
const response = await fetch('http://api/dictionaries?source=rabota.md');
const { data } = await response.json();

// –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–ø–∏—Å–æ–∫ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π
data.professions.forEach(prof => {
  bot.sendButton(prof.profession, prof.professionId);
});
```

### 2. –ü–∞—Ä—Å–∏–Ω–≥ —Å —Ç–æ—á–Ω—ã–º ID —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
```javascript
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç" (professionId="programmer")
const response = await fetch('http://api/vacancies/force-parse', {
  method: 'POST',
  body: JSON.stringify({
    sources: ['rabota.md'], // –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫
    searchQuery: 'programmer' // –¢–æ—á–Ω—ã–π ID
  })
});
```

### 3. –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–∏—Å–∫–æ–º
```javascript
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª "—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫"
// 1. –°–Ω–∞—á–∞–ª–∞ –¥–µ–ª–∞–µ–º —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
const mappings = await fetch('http://api/dictionaries/search?query=—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫');

// 2. –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–µ profession –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
// rabota.md: "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç"
// 999.md: "—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫"
// makler.md: "IT —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç"

// 3. –ü–∞—Ä—Å–∏–º –∫–∞–∂–¥—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º
// (–ª–æ–≥–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∞–Ω–∞ –≤ VacancyManager)
```

---

## üìã –ú–∏–≥—Ä–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
```bash
npm run db:migrate
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É `ProfessionDictionary`

### –®–∞–≥ 2: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Prisma –∫–ª–∏–µ–Ω—Ç
```bash
npm run db:generate
```

### –®–∞–≥ 3: –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
```bash
npm run build
```

### –®–∞–≥ 4: –û–±–Ω–æ–≤–∏—Ç—å —Å–ª–æ–≤–∞—Ä–∏–∫–∏ (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)
```bash
# –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
npm run dict:update

# –ò–ª–∏ —á–µ—Ä–µ–∑ API (–ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞)
curl -X POST http://localhost:3000/api/dictionaries/update
```

### –®–∞–≥ 5: –ó–∞–ø—É—Å—Ç–∏—Ç—å API
```bash
npm run dev:api
```

### –®–∞–≥ 6: –ó–∞–ø—É—Å—Ç–∏—Ç—å Worker (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
npm run dev:worker
```

---

## üìä API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –í–∞–∫–∞–Ω—Å–∏–∏
- `GET /api/vacancies` - –ü–æ–∏—Å–∫ –≤–∞–∫–∞–Ω—Å–∏–π
- `GET /api/vacancies/:id` - –ü–æ–ª—É—á–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é
- `GET /api/vacancies/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `POST /api/vacancies/force-parse` - –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥

### –°–ª–æ–≤–∞—Ä–∏–∫–∏
- `GET /api/dictionaries` - –í—Å–µ —Å–ª–æ–≤–∞—Ä–∏–∫–∏
- `GET /api/dictionaries?source=rabota.md` - –°–ª–æ–≤–∞—Ä–∏–∫ –¥–ª—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- `GET /api/dictionaries/search?query=X` - –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
- `GET /api/dictionaries/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `POST /api/dictionaries/update` - –û–±–Ω–æ–≤–∏—Ç—å —Å–ª–æ–≤–∞—Ä–∏–∫–∏
- `DELETE /api/dictionaries` - –û—á–∏—Å—Ç–∏—Ç—å —Å–ª–æ–≤–∞—Ä–∏–∫

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä–∏–∫–æ–≤

–î–æ–±–∞–≤—å—Ç–µ –≤ cron (—Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é):
```bash
0 0 * * 0 cd /path/to/project && npm run dict:update
```

–ò–ª–∏ —á–µ—Ä–µ–∑ Worker (–¥–æ–±–∞–≤–∏—Ç—å –≤ worker.ts):
```typescript
await parseQueue.add(
  'update-dictionaries',
  {},
  {
    repeat: {
      every: 7 * 24 * 60 * 60 * 1000 // –†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é
    }
  }
);
```

---

## üéâ –ò—Ç–æ–≥–æ

**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
1. ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ë–î ‚Üí –±—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã
2. ‚úÖ –§–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Üí –Ω–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
3. ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ ‚Üí —Ç–æ—á–Ω–æ—Å—Ç—å
4. ‚úÖ –°–ª–æ–≤–∞—Ä–∏–∫–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π ‚Üí —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å
5. ‚úÖ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ ‚Üí –≥–∏–±–∫–æ—Å—Ç—å
6. ‚úÖ API –¥–ª—è –±–æ—Ç–∞ ‚Üí –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç `dict:update` –≤ package.json
2. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –≤ VacancyManager (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä–∏–∫–æ–≤
