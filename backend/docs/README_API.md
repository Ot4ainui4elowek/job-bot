# üöÄ Vacancy Parser & API

–°–∏—Å—Ç–µ–º–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤–∞–∫–∞–Ω—Å–∏–π —Å –º–æ–ª–¥–∞–≤—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤ (rabota.md, 999.md, makler.md) —Å API –∏ —Ñ–æ–Ω–æ–≤—ã–º worker'–æ–º.

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/src
  /api              # Fastify API —Å–µ—Ä–≤–µ—Ä
    /routes         # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
    /services       # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
    server.ts       # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª API
  /worker           # BullMQ worker –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
    /jobs           # –ó–∞–¥–∞—á–∏ (–ø–∞—Ä—Å–∏–Ω–≥, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
    worker.ts       # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª worker
  /db               # Prisma –∫–ª–∏–µ–Ω—Ç
  /parsers          # –ü–∞—Ä—Å–µ—Ä—ã –≤–∞–∫–∞–Ω—Å–∏–π
    /adapters       # –ê–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
  /shared           # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
    /config         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
  /types            # TypeScript —Ç–∏–ø—ã
```

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª

```env
# Database
DATABASE_URL="postgresql://postgres:password@localhost:5432/vacancy?schema=public"

# API
API_PORT=3000
API_HOST=0.0.0.0

# Redis (–¥–ª—è BullMQ Worker)
REDIS_HOST=localhost
REDIS_PORT=6379

# Worker
WORKER_CONCURRENCY=3
PARSE_INTERVAL=21600000  # 6 —á–∞—Å–æ–≤ –≤ –º—Å
NOTIFY_INTERVAL=7200000  # 2 —á–∞—Å–∞ –≤ –º—Å

# Development
NODE_ENV=development
```

### 3. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

–í pgAdmin —Å–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É `vacancy` (–∏–ª–∏ –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ DATABASE_URL).

### 4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
npm run db:migrate
```

## üöÄ –ó–∞–ø—É—Å–∫

### Development —Ä–µ–∂–∏–º (—Å hot reload)

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å API —Å–µ—Ä–≤–µ—Ä
npm run dev:api

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Worker (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
npm run dev:worker
```

### Production —Ä–µ–∂–∏–º

```bash
# –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
npm run build

# –ó–∞–ø—É—Å—Ç–∏—Ç—å API
npm run start:api

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Worker
npm run start:worker
```

## üìö API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### Health Check
```
GET /health
```

### –ü–æ–ª—É—á–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏–∏
```
GET /api/vacancies

Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - keywords: —Å—Ç—Ä–æ–∫–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä: "javascript,node.js")
  - locations: –ª–æ–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
  - salaryMin: –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞
  - experience: –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã (no_experience, between_1_and_3, etc)
  - schedule: –≥—Ä–∞—Ñ–∏–∫ (remote, office, hybrid)
  - sources: –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (rabota.md, 999.md, makler.md)
  - limit: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)
  - offset: —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

–ü—Ä–∏–º–µ—Ä:
GET /api/vacancies?keywords=javascript&salaryMin=50000&schedule=remote&limit=20
```

### –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤–∞–∫–∞–Ω—Å–∏—é
```
GET /api/vacancies/:id
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```
GET /api/vacancies/stats
```

## üîß –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# Development
npm run dev:api          # –ó–∞–ø—É—Å—Ç–∏—Ç—å API –≤ dev —Ä–µ–∂–∏–º–µ
npm run dev:worker       # –ó–∞–ø—É—Å—Ç–∏—Ç—å Worker –≤ dev —Ä–µ–∂–∏–º–µ

# Production
npm run build            # –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
npm run start:api        # –ó–∞–ø—É—Å—Ç–∏—Ç—å API
npm run start:worker     # –ó–∞–ø—É—Å—Ç–∏—Ç—å Worker

# Database
npm run db:migrate       # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
npm run db:studio        # –û—Ç–∫—Ä—ã—Ç—å Prisma Studio
npm run db:generate      # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Prisma Client

# Testing
npm test                 # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
npm run test:watch       # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –≤ watch —Ä–µ–∂–∏–º–µ

# Code quality
npm run lint             # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥
npm run prettier         # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
```

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–°—Ö–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç:
- **User** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- **UserSettings** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Subscription** - –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏–∏
- **Vacancy** - –≤–∞–∫–∞–Ω—Å–∏–∏ (—É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
- **ParseLog** - –ª–æ–≥–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞

–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —É–¥–æ–±–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:
```bash
npm run db:studio
```

## üîÑ Worker (—Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏)

Worker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü–∞—Ä—Å–∏—Ç –≤–∞–∫–∞–Ω—Å–∏–∏ –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ .env)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ë–î
- –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ —Å retry


## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –î–ª—è —Ä–∞–±–æ—Ç—ã Worker'–∞ –Ω—É–∂–µ–Ω **Redis**. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker:
  ```bash
  docker run -d -p 6379:6379 redis:alpine
  ```

- API —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000 (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ .env)

- Worker –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç API –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

## üêõ Troubleshooting

**–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DATABASE_URL –≤ .env
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞

**–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis:**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Redis –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ REDIS_HOST –∏ REDIS_PORT –≤ .env

**Worker –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
- –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ Redis
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
